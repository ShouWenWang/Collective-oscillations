# Collective-oscillations

This is the distributed code for the manuscript:  Shou-Wen Wang & Lei-Han Tang, Emergence of collective oscillations in adaptive cells, https://arxiv.org/abs/1809.06997.   The code has been tested successfully on MacOS 10.14.4.


## Structure
1) **Mathematica_code_for_glycolysis**: mathematica-based code for glycolysis related models;  The code has been tested successfully on Mathematica 10.4.1.0.				

   a) **glycolysis_dupreez2 _unperturb_19_6_7**:  the original dupreez2 model, no perturbation is done here
   
   b) **glycolysis_dupreez2 _perturbed_19_6_7**:  the modified dupreeze2 model.  Response of the system to stepwise or periodic change of ACE is computed and a phase diagram of the whole system is generated. In particular, it includes the following two models
      
         i) glycolysisACE: perturbation of the original model by changing the ACE level
      
         ii) glycolysisACEremoveGLYCO: perturbation of the model without the GLYO reaction
      
   c) **glycoACEpert_Phase_diagram**: data generated by glycolysis_dupreez2 _perturbed_19_6_7 for making the phase diagram in Fig. 5
   
   d) **minimum_Model_glycolysis_19_6_7**: the minimum model we constructed based on the response features of the full model.  
   
         i) only the model for the intracellular circuit
      
         ii) intracellular circuit + ACE diffusion to allow cell-to-cell communication, assuming fast signal diffusion
      
         iii) intracellular circuit + ACE diffusion to allow cell-to-cell communication, explicitly treat signal inside and outside the cell, with the diffusion speed controlled by the diffusion constant
  
2) **Matlab_code_for_collective_oscillations**: matlab-based code for all other models and calculations in this manuscript. The code has been tested successfully on Matlab R2018a.			

   a) **startup**: a script that add the files to the searching path of matlab

   b) **adaptation**: to compute Fig. 3 and related Supplemental Figures.
   
       i) Main_compute_oscillation_fre_amp_and_compare_predict_adaptation: numerically compute the oscillation amplitude and frequency from a given adaptive model and compare it to the prediction based from the analytic approximation of the adaptive spectrum
   
       ii) main_compute_relation_adaptError_and_minSignalTimeScale: compute the relationship between the adaptation error epsilon and the minimum signal timescale tau that is needed to induce collective oscillations (whatever the cell density is needed)
      
       iii) paper_fig_plot_adaptation_oscillation: explore various functions, compute the numerically exact response spectrum etc.
       
       iV) functions: includes all sorts functions
       
   c) **FitzHugh-Nagumo Model**: use the main function there to compute Fig. 4 and Fig. 6
   
   d) **glycolysis**: It is a matlab implementation of the mathematica vdersion "inimum_Model_glycolysis_19_6_7". Use the main functions there to compute Fig.S13-15        
   
   e) **My_Common_Function** and **functions**: common functions for plot setting, and computation of the response spectrum or correlation spectrum etc. 
     
   
